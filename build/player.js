// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  this.Player = (function() {
    Player.prototype.BASE_Z = 12.5;

    Player.prototype.START = new THREE.Vector3(0, -150, 12.5);

    Player.prototype.onGround = true;

    Player.prototype.sliding = false;

    Player.prototype.rotateDown = false;

    Player.prototype.rotateUp = false;

    Player.prototype.movingLeft = false;

    Player.prototype.movingRight = false;

    Player.prototype.left = false;

    Player.prototype.right = false;

    Player.prototype.center = true;

    function Player(game) {
      this.slideUp = bind(this.slideUp, this);
      this.slideDown = bind(this.slideDown, this);
      this.update = bind(this.update, this);
      this.cube = new Cube(game, 10, 10, 15);
      this.cube.setColor(0xbdc3c7);
      this.cube.setPosition(this.START.x, this.START.y, this.START.z);
      this.cube.setMass(1);
      this.cube.setName('Player');
    }

    Player.prototype.update = function() {
      var position;
      if (this.rotateDown) {
        this.slideDown();
      } else if (this.rotateUp) {
        this.slideUp();
      } else if (this.movingLeft) {
        this.moveLeft();
      } else if (this.movingRight) {
        this.moveRight();
      }
      position = this.cube.object.position;
      this.onGround = position.z <= this.BASE_Z;
      return this.cube.setPosition(position.x, position.y + 1, position.z);
    };

    Player.prototype.jump = function() {
      if (this.sliding) {
        this.sliding = false;
        this.rotateUp = true;
        return;
      }
      if (!this.onGround) {
        return;
      }
      return this.cube.object.applyCentralImpulse(new THREE.Vector3(0, 0, 30));
    };

    Player.prototype.inAction = function() {
      return this.sliding || this.rotateDown || this.rotateUp || this.movingLeft;
    };

    Player.prototype.startSlide = function() {
      if (!this.inAction()) {
        return this.rotateDown = true;
      }
    };

    Player.prototype.startLeft = function() {
      if (!(this.inAction() || this.left)) {
        return this.movingLeft = true;
      }
    };

    Player.prototype.startLeft = function() {
      if (!(this.inAction() || this.left)) {
        return this.movingLeft = true;
      }
    };

    Player.prototype.startRight = function() {
      if (!(this.inAction() || this.right)) {
        return this.movingRight = true;
      }
    };

    Player.prototype.moveRight = function() {
      if (this.center) {
        if (this.cube.object.position.x >= 20.0) {
          this.movingRight = false;
          this.right = true;
          this.center = false;
          return;
        }
      } else if (this.left) {
        if (this.cube.object.position.x >= 0.0) {
          this.movingRight = false;
          this.center = true;
          this.left = false;
          return;
        }
      }
      this.cube.moveX(0.5);
      return this.cube.rotateZ(-2.25);
    };

    Player.prototype.moveLeft = function() {
      if (this.center) {
        if (this.cube.object.position.x <= -20) {
          this.movingLeft = false;
          this.left = true;
          this.center = false;
          return;
        }
      } else if (this.right) {
        if (this.cube.object.position.x <= 0) {
          this.movingLeft = false;
          this.center = true;
          this.right = false;
          return;
        }
      }
      this.cube.moveX(-0.5);
      return this.cube.rotateZ(2.25);
    };

    Player.prototype.slideDown = function() {
      if (this.cube.object.rotation.x >= (90 * DEGREES_TO_RADIANS)) {
        this.rotateDown = false;
        this.sliding = true;
        return;
      }
      return this.cube.rotateX(3);
    };

    Player.prototype.slideUp = function() {
      if (this.cube.object.rotation.x <= (0 * DEGREES_TO_RADIANS)) {
        this.rotateUp = false;
        return;
      }
      return this.cube.rotateX(-3);
    };

    Player.prototype.reset = function() {
      return this.cube.setPosition(this.START.x, this.START.y, this.START.z);
    };

    Player.prototype.getObject = function() {
      return this.cube.object;
    };

    Player.prototype.getPosition = function() {
      return this.cube.object.position;
    };

    return Player;

  })();

}).call(this);
